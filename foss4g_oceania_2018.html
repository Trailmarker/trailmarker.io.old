<!DOCTYPE html>
<html lang="en"><head><title>Dr Strangedata; or, How I Learned to Stop Worrying and Love the_geom</title><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport"><link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"><link href="foss4g_oceania_2018/trailmarker-strangelove/trailmarker-strangelove.css" rel="stylesheet" type="text/css"><link href="foss4g_oceania_2018/css/reveal.css" rel="stylesheet" type="text/css"><link href="foss4g_oceania_2018/css/night.min.css" rel="stylesheet" type="text/css"><link href="foss4g_oceania_2018/css/leaflet.css" rel="stylesheet" type="text/css"><link href="foss4g_oceania_2018/stylesheet.css" rel="stylesheet" type="text/css"><script src="foss4g_oceania_2018/js/jquery-3.1.1.slim.min.js" type="text/javascript"></script></head><body><div class="reveal"><div class="slides"><section class="centred-slide"><img class="slideshow-background" src="foss4g_oceania_2018/img/columbia_intro.png"></section><section class="centred-slide" data-state="title-slide"><h1 class="strangelove-title">Dr. StrangeData, Or:</h1><br><h1 class="strangelove-title">How I Learned To Stop</h1><br><h1 class="strangelove-title">Worrying, And Love</h1><br><h1 class="strangelove-title huge">the_geom</h1></section><section class="centred-slide light-scheme"><img class="slideshow-background" src="foss4g_oceania_2018/img/spatial_galaxy_meme.png"></section><section class="light-scheme"><h1>Performance in spatial systems</h1><div><p>A short, non-exhaustive list of historical big bangs in GIS that were invented to alleviate performance issues</p><ul><li>Spatial indexes</li><li>Image overviews or "raster pyramids"</li><li>Pre-rendered cartographic raster tile caches</li><li>Vector tiles (sort of)</li></ul><p>Fixing our problems has always been about Big Ideas—but do we give them too much credit?</p></div></section><section class="light-scheme"><h1>Guarantees and upper bounds</h1><img src="foss4g_oceania_2018/img/reactive_systems.png" style="width: 80%;"><div><p>(<em>excerpted from The Reactive Manifesto</em>)</p></div></section><section class="light-scheme"><h1>Why guarantees are nice</h1><div><p></p><table> <thead> <tr> <th></th> <th>Guarantees</th> <th>Big Ideas</th> </tr> </thead> <tbody> <tr> <td>User experience</td> <td>The <em>worst</em> experience is defined</td> <td>The <em>average</em> experience is improved</td> </tr> <tr> <td>What do we know?</td> <td>The worst for a system is no worse than the worst of all of its components</td> <td>We don't readily know how components' good and bad behaviour will relate</td> </tr> <tr> <td>Design decisions</td> <td>Can be made with confidence for the worst case</td> <td>Can only be made with some risk</td> </tr> </tbody> </table><p></p></div></section><section class="light-scheme"><h1>An application feature - is it safe?</h1><div><ul><li>The user defines an Area of Interest in relation to a set of configured layers</li><li>The geographical intersection of each layer with the Area of Interest  is computed and extracted or visualised</li></ul></div><img src="foss4g_oceania_2018/img/martinez_example.png"></section><section class="light-scheme"><h1>How can we reason about this feature?</h1><div><ul><li>What does openness buy us in our software foundations?</li><li>In Turfjs, for example, the algorithm used is the the <a href="https://github.com/w8r/martinez">Martinez-Rueda polygon clipping algorithm</a></li><li>The complexity of the Martinez algorithm is <span style="font-style: italic; font-size: 120%">O((n+k)*log(n))</span>, where:<ul><li><em>n</em> is the number of <strong>all edges</strong> in the interacting polygons</li><li><em>k</em> is the number of <strong>all interactions</strong> between polygon edges</li></ul></li><li>O(n*log(n)) is already not too great, but more importantly, we're dependent not just on the size, but on the <em>spatial relations</em> of the input data</li><li>Useful guarantees are very hard to get</li></ul></div></section><section class="light-scheme"><h1>Measuring input data size</h1><div><ul><li>Most commonly, this can mean measuring the number of points in a geometry representation:<ul><li>SELECT ST_NPoints(geom);</li><li>console.log(linestring.coordinates.length);</li></ul></li></ul></div></section><section class="light-scheme"><h1>Measuring spatial relatedness</h1><div><ul><li>Reality bites: patterns of relation between geographical <em>records</em> are often un-recorded relations of the <em>real things</em> they map</li><li>We don't (yet) have a mainstream technical practice that understands that "in the suburbs, roads and houses go together"<ul><li>ideas like spatial correlation, proximity analysis, and similarity measures</li><li>ad hoc measures, eg "mean envelope per feature in a layer"<br></li></ul></li><li><strong>However</strong>: these patterns make a very big difference to the risk and variation of spatial operation complexity</li></ul></div></section><section class="light-scheme"><h1>Estimating job size</h1><div><ul><li>Use a simplified representation of application data to pre-estimate the cost of a full process<ul><li>eg run an intersection against a <em>square covering</em> of the application's reference layers, instead of the layers themselves</li></ul></li></ul></div></section><section class="light-scheme"><h1>Risk mitigation</h1><div><ul><li>Simplifying input data through application constraints—for example<ul><li>eg the Area of Interest can only be a bounding box</li><li>eg the Area of Interest can only have a maximum total area</li><li>In many cases, these restrictions may be unacceptable</li></ul></li><li>Reducing the size of input data<ul><li>Curating purpose-built simplified variants of reference layers</li></ul></li></ul></div></section><section class="light-scheme"><h1>Mitigation - Prevention</h1><div><ul><li>Prevent complex data (especially with low value) from entering the system</li><li>Very important for systems that offer to <em>ingest</em> user data<ul><li><span style="color: red;">We're sorry, the maximum number of drill points you can upload is 1000</span></li></ul></li><li>Proactively report or alert when time and size limits are exceeded<ul><li>Record any related interactive user input and use in testing</li></ul></li><li><strong>Question</strong>: how to reason about global limits given the metrics of a new record?</li></ul></div></section><section class="light-scheme"><h1>Mitigation - Concealment</h1><div><ul><li>Run processes asynchronously, or in the background<ul><li>But only when their estimated complexity exceeds a configured threshold</li><li>… which also requires you to have an estimate</li></ul></li></ul></div></section><section class="light-scheme"><h1>Exploration - Exercise all data</h1><div><ul><li>Select, run and measure exemplary data in all operations</li><li>Identify the "worst cases" currently in the system and report</li></ul></div></section><section class="light-scheme"><h1>Exploration - Generate and exercise random data with the same attributes</h1><div><ul><li>An area poorly served by current libraries and frameworks</li><li>Turfjs provides <code>@turf/random</code>, which can generate random polygons, linestrings and points within a bbox<ul><li>but eg only generates "simple" polygons using a radial method</li></ul></li><li>Generic PostgreSQL tools do not provide useful support for geometry</li><li>There is no mainstream tool to generate data that's "similar" to a provided dataset, or data that expresses eg the spatial relatedness of two or more layers</li><li>For developers: there is a gap for suitable generators for property-based testing frameworks in your favourite language</li></ul></div></section><section class="light-scheme"></section><section data-state="map-slide"><div class="slideshow-map"></div><p class="raise-z-index">Map 1</p></section><section data-state="map-slide"><div class="slideshow-map"></div><p class="raise-z-index">Map 2</p></section><section><p>Slide 3</p></section></div></div><script src="foss4g_oceania_2018/js/reveal.min.js" type="text/javascript"></script><script src="foss4g_oceania_2018/js/leaflet.js" type="text/javascript"></script><script src="foss4g_oceania_2018/script.js"></script></body></html>